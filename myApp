{"files":[{"id":"abe6f6fe-f6e3-4d5b-aff6-a43c89f1f4bc","name":"Code","type":"server_js","source":"function myFunction() \n{\n  var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1YeRU4UabaBcMUjA2SApQXksT-x_bXbVxHOjL-2-P16E/edit#gid\u003d1716476145\");\n  var sheet \u003d ss.getActiveSheet();\n  var lastRow \u003d ss.getLastRow();\n  \n  var name \u003dsheet.getRange(2, 2).getValue();\n \n  \n  Logger.log(name);\n  \n}\n"},{"id":"92af41a7-1129-4970-bdfe-af96cf79694c","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Kolkata\",\n  \"dependencies\": {\n  },\n  \"webapp\": {\n    \"access\": \"MYSELF\",\n    \"executeAs\": \"USER_DEPLOYING\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"},{"id":"10876f37-dc5b-4191-89e2-2028a2f187e0","name":"bithdaywish","type":"server_js","source":"function sendBirthdayWish()\n{\n  var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1YeRU4UabaBcMUjA2SApQXksT-x_bXbVxHOjL-2-P16E/edit#gid\u003d1716476145\");\n  var sheet \u003d ss.getActiveSheet();\n  var lastRow \u003d ss.getLastRow();\n  var templateId \u003d \u002718hFJF96wET1hJHoMWOE4k8c_IwpXo5y9oL2pboMktf0\u0027;\n  var current_date \u003d new Date();\n  var i\u003d2;\n  var current_date \u003d Utilities.formatDate(new Date(), \u0027GMT\u0027,\u0027MMMM-dd-yyyy\u0027);\n  \n  for(i;i\u003c\u003dlastRow;i++)\n  {\n    var birthdayDate \u003d Utilities.formatDate(sheet.getRange(i,3).getValue(),\u0027GMT\u0027,\u0027MMMM-dd-yyyy\u0027);\n    \n    if(current_date\u003d\u003dbirthdayDate)\n    {\n      var name \u003d sheet.getRange(i,4).getValue();\n      var tomail \u003d sheet.getRange(i,2).getValue();\n      sendwish(name,tomail,sheet,templateId);\n    }\n    \n  }\n  \n}\nfunction sendwish(name,tomail,sheet,templateId)\n{\n  var newdocid \u003d DriveApp.getFileById(templateId).makeCopy(\u0027temp\u0027).getId();\n  var docopen \u003d DocumentApp.openById(newdocid);\n  var body \u003d docopen.getBody();\n  \n  body.replaceText(\u0027#name#\u0027,name);\n  docopen.saveAndClose();\n  var url \u003d \"https://docs.google.com/feeds/download/documents/export/Export?id\u003d\"+newdocid+\"\u0026exportFormat\u003dhtml\";\n\tvar param \u003d {\n\tmethod      : \"get\",\n\theaders     : {\"Authorization\": \"Bearer \" +  ScriptApp.getOAuthToken()}\n\t};\n  var htbody \u003d UrlFetchApp.fetch(url,param).getContentText();\n  var trashed \u003d DriveApp.getFileById(newdocid).setTrashed(true);\n  MailApp.sendEmail(tomail,\u0027HAPPY BIRTHDAY\u0027+name,\u0027\u0027,{htmlBody:htbody});\n}"}]}